<!DOCTYPE html>
<html lang="pt-br">
<head>
	<meta charset="utf-8">
	<meta name='author' content="Danilo Santana">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="./icon/favicon.ico">
	<!--icons-->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/v4-shims.css">
  <!--||-->
  <!--fonts-->
  <link id="newFont" href="" rel="stylesheet">
  <!--||-->
	<link rel="stylesheet" type="text/css" href="./css/style.css">
	<!--aditional libs-->
  <link id="cssLibLocation0" rel="stylesheet" href="">
  <script id="jsLibLocation0" src=""></script>
  <link id="cssLibLocation1" rel="stylesheet" href="">
  <script id="jsLibLocation1" src=""></script>
  <!--||-->
	<title id='title'>Meow Code </title>
</head>
<body id="body" style="margin: 0; position: fixed; font-family: sans-serif;	width: 100%; height: 100%; font-size: 17px;">
	<div class="app">
		<div class="side-menu" id="sideMenu">
			<div class="box">
				<div class="open-libs" id="openLibs" title="adicionar libs">
					<i class="fas fa-file-archive"></i>
				</div>
				<div class="import-file" title="abrir arquivo" id="importFile">
					<i class="fas fa-folder-open"></i>
				</div>
				<div class="export-file" title="salvar arquivo" id="exportFile">
					<i class="fas fa-save"></i>
				</div>
				<div class="open-config" id="openConfig" title="configurações">
					<i class="fas fa-cog"></i>
				</div>
			</div>
		</div>
		<div class="new-window">
			<div class="libs-window" id="libsWindow" style="display: none;">
				<input type="text" id="jsLib0" placeholder="js lib 0" />
				<input type="text" id="cssLib0" placeholder="css lib 0" />
				<input type="text" id="jsLib1" placeholder="js lib 1" />
				<input type="text" id="cssLib1" placeholder="css lib 1" />
				<button id="setLibs">set libs</button>
			</div>
			<div class="config-window" id="configWindow" style="display: none;">
				<div class="config-container" id='configContainer'>
					<div class="system-container">
						<h4>Sistema</h4>
						<div>
							<p>Tempo de inicialização: <b id="startTime"></b>ms</p>
						</div>
					</div>
					<hr style="width: 95%; margin-left: 0;" />
					<div class="ide-container">
						<h4>IDE</h4>
						<div>
							<p>Tema atual: <b id="currentTheme"></b></p>
							<p>Tamanho da fonte: <b id="font"></b></p>
						</div>
					</div>
				</div>
			</div>
			<div class="archive-window" id="archiveWindow" style="display: none;">
				<input type="text" id="archiveNameExport" placeholder="nome do arquivo" />
			</div>
			<div class="archive-window" id="importWindow" style="display: none;">
				<input type="text" id="archiveNameImport" placeholder="nome do arquivo" />
			</div>
		</div>
		<div class="main">
			<div class="debug-window">
				<div class="inputs">
					<textarea
						id="input"
						wrap="soft"
						class="debug-input"
						type="text"
						placeholder=">"
					></textarea>
				</div>
				<div class="debug-output" id="output" style="display: none;">
				</div>
			</div>
		</div>
		<div class="footer">
			<div class="content">
				<p class="clock" id="clock"></p>
				<p class="separator">|</p>
				<p class="theme" id="theme">theme: </p>
				<p class="separator">|</p>
				<p>font-size:</p>
				<input type="number" class="footer-label" id="fontSize" value="16" />
				<p class="separator">|</p>
				<button id="onOff" class="bottom-btn">html preview off</button>
				<p class="separator">|</p>
				<b style="margin-top: -1px;"><p id="event" style="color: orange; text-decoration: underline;"></p></b>
				<div class="contain" style="display: flex; position: fixed; right: 10px;">
					<p style="color: #fff;">><b style="text-decoration: underline; color: yellow">Ctrl+Shift+I</b></p>
					<p style="color: #fff;">&nbsp;para abrir o console!</p>
				</div>
			</div>
		</div>
	</div>
	<script>
		// exportar o projeto
		const fs = require('fs');

		var n;

		function reset(){
			setTimeout(() => {
		    document.getElementById('event').innerHTML = '';
		  }, 1000);
		}

		document.getElementById('archiveNameExport').addEventListener('keydown', (keydown) => {
		  switch (keydown.keyCode) {
		  	case 13: // ENTER
		  		exportFile();
		  		break;
		  	default:
		  		null;
		  		break;
		  }
		});
		document.getElementById('archiveNameImport').addEventListener('keydown', (keydown) => {
		  switch (keydown.keyCode) {
		  	case 13: // ENTER
		  		importFile();
		  		break;
		  	default:
		  		null;
		  		break;
		  }
		});

		// salvar e criar arquivo
		function exportFile(){

			// nome do arquivo
			let name = document.getElementById('archiveNameExport');
			// escrever
			fs.writeFile('./build/'+name.value, document.getElementById('input').value, (error)=>{

				if(error){
					throw error;
				}
				console.log('projeto salvo');
			});

			document.getElementById('archiveWindow').style.display = 'none';
			document.getElementById('event').innerHTML = name.value+' salvo!';
			reset();
			n = name.value;
			name.value = '';
		}
		// importar a arquivo
		function importFile(){

			let name = document.getElementById('archiveNameImport');

			fs.readFile("./build/"+name.value, (error, content)=>{

				if(error){
					throw error;
				}
				document.getElementById('input').value = content;
			});
			console.log('arquivo importado: '+name.value);
			document.getElementById('importWindow').style.display = 'none';
			document.getElementById('event').innerHTML = 'arquivo importado: '+name.value;
			reset();
			n = name.value;
			name.value = '';
			console.log(n);
		}

		document.addEventListener('keydown', (keydown) => {
			switch (keydown.keyCode) {
				case 27: // ESC
		  		document.getElementById('archiveWindow').style.display = 'none';
		  		document.getElementById('importWindow').style.display = 'none';
		  		break;
		  	case 117: // F6 para salvar o arquivo aberto no momento
		  		fs.writeFile('./build/'+n, document.getElementById('input').value, (error)=>{
		  			if(error){
		  				throw error;
		  			}
		  			document.getElementById('event').innerHTML = 'arquivo salvo: '+n;
		  			reset();
		  			console.log('arquivo salvo:', n);
		  		});
		  		break;
		  	default:
		  		null;
		  		break;
			}
		});
	</script>
	<script src="./theme.js"></script>
	<script src="./js/snippets.js"></script>
	<script src="./js/index.js"></script>
</body>
</html>